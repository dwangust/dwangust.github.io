{% assign groups = "preprint,journal,conference" | split: "," %}
{% assign labels = "Preprints,Journals,Conferences" | split: "," %}

{% for g in groups %}
  {% assign idx = forloop.index0 %}
  {% assign label = labels[idx] %}
  {% assign items = site.data.publications[g] %}

  {% if items and items.size > 0 %}
    <h2 style="margin-top: 1.4em;">{{ label }}</h2>

    {%- comment -%}
    可选：分组内按 year 从大到小排序
    {%- endcomment -%}
    {% assign sorted = items | sort: "year" | reverse %}

    <ol style="padding-left: 1.2em;">
      {% for p in sorted %}
        <li style="margin: 0.55em 0;">
          <div>
            <strong>{{ p.title }}</strong>
          </div>
          <div>
            {{ p.authors }}<br/>
            <em>
              {% if p.venue %}{{ p.venue }}{% endif %}
              {% if p.year %}, {{ p.year }}{% endif %}
            </em>
            {% if p.note and p.note != "" %}
              — {{ p.note }}
            {% endif %}

            {% if p.links and p.links.size > 0 %}
              <span> | </span>
              {% for l in p.links %}
                <a href="{{ l.url }}">{{ l.name }}</a>{% unless forloop.last %} / {% endunless %}
              {% endfor %}
            {% endif %}
          </div>
        </li>
      {% endfor %}
    </ol>
  {% endif %}
{% endfor %}
